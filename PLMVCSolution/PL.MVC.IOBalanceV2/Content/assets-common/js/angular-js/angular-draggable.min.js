angular.module("ngDraggable",[]).service("ngDraggable",[function(){var n=this;n.inputEvent=function(n){return angular.isDefined(n.touches)?n.touches[0]:angular.isDefined(n.originalEvent)&&angular.isDefined(n.originalEvent.touches)?n.originalEvent.touches[0]:n}}]).directive("ngDrag",["$rootScope","$parse","$document","$window","ngDraggable",function(n,t,i,r,u){return{restrict:"A",link:function(f,e,o){f.value=o.ngDrag;var w,d=!1,s,h,c,l,g,nt,ut="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,ft="touchstart mousedown",b="touchmove mousemove",k="touchend mouseup",tt,et=f.$id,a=null,v=null,p=!1,ot=null,st=t(o.ngDragStart)||null,ht=t(o.ngDragStop)||null,ct=t(o.ngDragSuccess)||null,it=angular.isDefined(o.allowTransform)?f.$eval(o.allowTransform):!0,wt=t(o.ngDragData),lt=angular.noop,bt=function(){var n;e.attr("draggable","false");n=e[0].querySelectorAll?angular.element(e[0].querySelectorAll("[ng-drag-handle]")):e.find("[ng-drag-handle]");n.length&&(tt=n);at(!0)},at=function(n){if(n){if(f.$on("$destroy",kt),f.$watch(o.ngDrag,dt),f.$watch(o.ngCenterAnchor,gt),tt)tt.on(ft,vt);else e.on(ft,vt);if(!ut&&e[0].nodeName.toLowerCase()=="img")e.on("mousedown",function(){return!1})}},kt=function(){at(!1)},dt=function(n){p=n},gt=function(n){angular.isDefined(n)&&(d=n||"true")},ni=function(n){return angular.isDefined(angular.element(n.target).attr("ng-cancel-drag"))},vt=function(n){if(p&&!ni(n)&&(n.type!="mousedown"||n.button==0))if(ut){y();ot=setTimeout(function(){y();yt(n)},100);i.on(b,y);i.on(k,y)}else yt(n)},y=function(){clearTimeout(ot);i.off(b,y);i.off(k,y)},yt=function(t){if(p){t.preventDefault();w=e[0].getBoundingClientRect();v=it?w:{left:document.body.scrollLeft,top:document.body.scrollTop};e.centerX=e[0].offsetWidth/2;e.centerY=e[0].offsetHeight/2;s=u.inputEvent(t).pageX;h=u.inputEvent(t).pageY;g=s-w.left;nt=h-w.top;d?(c=s-e.centerX-r.pageXOffset,l=h-e.centerY-r.pageYOffset):(c=s-g-r.pageXOffset,l=h-nt-r.pageYOffset);i.on(b,rt);i.on(k,pt);lt=n.$on("draggable:_triggerHandlerMove",function(n,t){rt(t)})}},rt=function(t){p&&(t.preventDefault(),e.hasClass("dragging")||(a=wt(f),e.addClass("dragging"),n.$broadcast("draggable:start",{x:s,y:h,tx:c,ty:l,event:t,element:e,data:a}),st&&f.$apply(function(){st(f,{$data:a,$event:t})})),s=u.inputEvent(t).pageX,h=u.inputEvent(t).pageY,d?(c=s-e.centerX-v.left,l=h-e.centerY-v.top):(c=s-g-v.left,l=h-nt-v.top),ri(c,l),n.$broadcast("draggable:move",{x:s,y:h,tx:c,ty:l,event:t,element:e,data:a,uid:et,dragOffset:v}))},pt=function(t){p&&(t.preventDefault(),n.$broadcast("draggable:end",{x:s,y:h,tx:c,ty:l,event:t,element:e,data:a,callback:ti,uid:et}),e.removeClass("dragging"),e.parent().find(".drag-enter").removeClass("drag-enter"),ii(),i.off(b,rt),i.off(k,pt),ht&&f.$apply(function(){ht(f,{$data:a,$event:t})}),lt())},ti=function(n){ct&&f.$apply(function(){ct(f,{$data:a,$event:n})})},ii=function(){it?e.css({transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}):e.css({position:"",top:"",left:""})},ri=function(n,t){it?e.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+n+", "+t+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+n+", "+t+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+n+", "+t+")"}):e.css({left:n+"px",top:t+"px",position:"fixed"})};bt()}}}]).directive("ngDrop",["$parse","$timeout","$window","$document","ngDraggable",function(n,t,i,r){return{restrict:"A",link:function(i,u,f){i.value=f.ngDrop;i.isTouching=!1;var o=null,l=i.$id,e=!1,a=n(f.ngDropSuccess),v=n(f.ngDragStart),y=n(f.ngDragStop),p=n(f.ngDragMove),w=function(){c(!0)},c=function(n){n&&(i.$watch(f.ngDrop,k),i.$on("$destroy",b),i.$on("draggable:start",d),i.$on("draggable:move",g),i.$on("draggable:end",nt))},b=function(){c(!1)},k=function(n){e=n},d=function(n,r){e&&(s(r.x,r.y,r.element),f.ngDragStart&&t(function(){v(i,{$data:r.data,$event:r})}))},g=function(n,r){e&&(s(r.x,r.y,r.element),f.ngDragMove&&t(function(){p(i,{$data:r.data,$event:r})}))},nt=function(n,r){if(!e||l===r.uid){h(!1,r.element);return}s(r.x,r.y,r.element)&&(r.callback&&r.callback(r),f.ngDropSuccess&&t(function(){a(i,{$data:r.data,$event:r,$target:i.$eval(i.value)})}));f.ngDragStop&&t(function(){y(i,{$data:r.data,$event:r})});h(!1,r.element)},s=function(n,t,r){var f=tt(n,t);return i.isTouching=f,f&&(o=u),h(f,r),f},h=function(n,t){n?(u.addClass("drag-enter"),t.addClass("drag-over")):o==u&&(o=null,u.removeClass("drag-enter"),t.removeClass("drag-over"))},tt=function(n,t){var i=u[0].getBoundingClientRect();return n-=r[0].body.scrollLeft+r[0].documentElement.scrollLeft,t-=r[0].body.scrollTop+r[0].documentElement.scrollTop,n>=i.left&&n<=i.right&&t<=i.bottom&&t>=i.top};w()}}}]).directive("ngDragClone",["$parse","$timeout","ngDraggable",function(){return{restrict:"A",link:function(n,t){var r,i=!0;n.clonedData={};var o=function(){r=t.find("img");t.attr("draggable","false");r.attr("draggable","false");u();s(!0)},s=function(t){t&&(n.$on("draggable:start",c),n.$on("draggable:move",l),n.$on("draggable:end",a),h())},h=function(){r.off("mousedown touchstart touchmove touchend touchcancel",e);r.on("mousedown touchstart touchmove touchend touchcancel",e)},c=function(r,u){i=!0;angular.isDefined(u.data.allowClone)&&(i=u.data.allowClone);i&&(n.$apply(function(){n.clonedData=u.data}),t.css("width",u.element[0].offsetWidth),t.css("height",u.element[0].offsetHeight),f(u.tx,u.ty))},l=function(n,t){i&&(_tx=t.tx+t.dragOffset.left,_ty=t.ty+t.dragOffset.top,f(_tx,_ty))},a=function(){i&&u()},u=function(){t.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})},f=function(n,i){t.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+n+", "+i+", 0, 1)","z-index":99999,visibility:"visible","-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+n+", "+i+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+n+", "+i+")"})},e=function(n){var t=n;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};o()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(){return{restrict:"A",link:function(n,t){var i=function(){t.attr("draggable","false");r(!0)},r=function(n){if(n)t.on("mousedown touchstart touchmove touchend touchcancel",u)},u=function(n){var t=n.originalEvent;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};i()}}}]).directive("ngCancelDrag",[function(){return{restrict:"A",link:function(n,t){t.find("*").attr("ng-cancel-drag","ng-cancel-drag")}}}]).directive("ngDragScroll",["$window","$interval","$timeout","$document","$rootScope",function(n,t,i,r,u){return{restrict:"A",link:function(t,i,f){var o=null,e={verticalScroll:f.verticalScroll||!0,horizontalScroll:f.horizontalScroll||!0,activationDistance:f.activationDistance||75,scrollDistance:f.scrollDistance||15},h=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}(),s=!1,c=function(){function t(n){var i=Array.prototype.slice.call(arguments);s&&h(function(){u.$apply(function(){n.apply(null,i);t(n)})})}s=!0;t(function(){var s,h;if(o){var c=Math.max(document.documentElement.clientWidth,window.innerWidth||0),l=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=0,f=0;if(e.horizontalScroll&&(o.clientX<e.activationDistance?t=-e.scrollDistance:o.clientX>c-e.activationDistance&&(t=e.scrollDistance)),e.verticalScroll&&(o.clientY<e.activationDistance?f=-e.scrollDistance:o.clientY>l-e.activationDistance&&(f=e.scrollDistance)),t!==0||f!==0){var a=n.pageXOffset||r[0].documentElement.scrollLeft,v=n.pageYOffset||r[0].documentElement.scrollTop,y=i.css("transform");i.css("transform","initial");n.scrollBy(t,f);s=(n.pageXOffset||r[0].documentElement.scrollLeft)-a;h=(n.pageYOffset||r[0].documentElement.scrollTop)-v;i.css("transform",y);o.pageX+=s;o.pageY+=h;u.$emit("draggable:_triggerHandlerMove",o)}}})},l=function(){s=!1};t.$on("draggable:start",function(n,t){t.element[0]===i[0]&&(s||c())});t.$on("draggable:end",function(n,t){t.element[0]===i[0]&&s&&l()});t.$on("draggable:move",function(n,t){t.element[0]===i[0]&&(o=t.event)})}}}]);